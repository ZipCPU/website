<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Xilinx deleted this post</title>
  <meta name="description" content="I was originally going to title this article, “Digital design is not Legodesign”, but then Xilinx deleted the forum postit was based upon, so I’ve since chan...">

  <link rel="shortcut icon" type="image/x-icon" href="/img/GT.ico">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://zipcpu.com/blog/2019/08/20/lego-design.html">
  <link rel="alternate" type="application/rss+xml" title="The ZipCPU by Gisselquist Technology" href="https://zipcpu.com/feed.xml">
</head>


  <body>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-102570964-1', 'auto');
  ga('send', 'pageview');

</script>

    <header class="site-header">
  <div id="banner">
  <a href="/"><picture>
    <img height=120 id="site-logo" src="/img/fullgqtech.png" alt="Gisselquist Technology, LLC">
  </picture></A>
  </div>

  <div class="site-nav">
<ul>

<li><a HREF="/">Main/Blog</a>


<li><a HREF="/about/">About Us</a>


<li><a HREF="/fpga-hell.html">FPGA Hell</a>


<li><a HREF="/tutorial/">Tutorial</a>
<li><a HREF="/tutorial/#training">Formal training</a>


<li><a HREF="/quiz/quizzes.html">Quizzes</a>


<li><a HREF="/projects.html">Projects</a>


<li><a HREF="/topics.html">Site Index</a>

<HR>

<li><a href="https://twitter.com/zipcpu"><span class="icon--twitter"><svg viewBox="0 0 400 400"><path fill="#1da1f2" d="M153.62,301.59c94.34,0,145.94-78.16,145.94-145.94,0-2.22,0-4.43-.15-6.63A104.36,104.36,0,0,0,325,122.47a102.38,102.38,0,0,1-29.46,8.07,51.47,51.47,0,0,0,22.55-28.37,102.79,102.79,0,0,1-32.57,12.45,51.34,51.34,0,0,0-87.41,46.78A145.62,145.62,0,0,1,92.4,107.81a51.33,51.33,0,0,0,15.88,68.47A50.91,50.91,0,0,1,85,169.86c0,.21,0,.43,0,.65a51.31,51.31,0,0,0,41.15,50.28,51.21,51.21,0,0,1-23.16.88,51.35,51.35,0,0,0,47.92,35.62,102.92,102.92,0,0,1-63.7,22A104.41,104.41,0,0,1,75,278.55a145.21,145.21,0,0,0,78.62,23"/></svg>
</span><span class="username">@zipcpu</span></a>

<li><a href="https://www.reddit.com/r/ZipCPU"><span class="username">Reddit</a>
<li><a HREF="https://www.patreon.com/ZipCPU"><IMG SRC="/img/patreon_logomark_color_on_white.png" WIDTH="25"> Support</a>
</ul>
</div>


</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="https://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Xilinx deleted this post</h1>
    <p class="post-meta"><time datetime="2019-08-20T00:00:00-04:00" itemprop="datePublished">Aug 20, 2019</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>I was originally going to title this article, <em>“Digital design is not Lego
design”</em>, but then Xilinx deleted the <a href="https://forums.xilinx.com">forum</a> post
it was based upon, so I’ve since changed the title.  Here’s the story:</p>

<p>Recently, someone posted some fairly benign recommendations for beginners on
Xilinx’s forums.  I’d point you to the forum post so you could read these in
context, but like I mentioned above–Xilinx was apparently so upset by my
comments (copied below) that they deleted the whole discussion.</p>

<table align="center" style="float: none"><caption>Fig 1. Deleted!</caption><tr><td><a href="/img/tweets/xilinx-msg-not-found.png"><img src="/img/tweets/xilinx-msg-not-found.png" alt="" width="720" /></a></td></tr></table>

<p>Maybe I should start recording all of my discussions from now on …</p>

<p>The first individual to comment (sorry, his username has now been lost in the
web somewhere), shared his recommendations for a beginning designer.  In
particular, he was noting how much time you’d need to speed using the
simulator for a project, and if that was the case, why not spend your time
<a href="/blog/2018/08/22/what-is-simulation.html">learning to use the simulator
well</a> before
purchasing a dev board?</p>

<blockquote>
  <p>For a real project, you will have no choice but to simulate the $@ out of
it because it won’t work and your physical debugging will be meaningless.  So
why not focus on that?  The HDL and simulation environment are already a lot
to learn.  Then when you literally can’t do any more without hardware, you
will be in a better position to buy a board.</p>
</blockquote>

<p>In many ways, I agree with the sentiment–but with a few caveats that I’ll share
in a moment.</p>

<p>A well known and often very helpful user,
<a href="https://forums.xilinx.com/t5/user/viewprofilepage/user-id/74556">u4223374</a>,
responded with his own perspective, recommending a design approach I’ll call
“Lego design”.  He writes,</p>

<blockquote>
  <p>Increasingly these days an FPGA designer can get away without any hardware
knowledge.  With Xilinx (and others) providing IP cores for most of the
common interfaces, the unique processing hardware doesn’t tend to need any
external-to-the-FPGA communications at all – it just talks to the I/O IP
cores</p>
</blockquote>

<p>… <em>without any hardware knowledge</em>?  Incredible.  Let’s just say I disagree.</p>

<p>After I responded, Xilinx then deleted the whole post.  The next section 
contains my response, which is what I will assume offended them.  I didn’t
copy and paste it, though, but rather fat-fingered typing it in so you might
find subtle spelling differences.  I’ve also added hyperlinks links to the
discussion for anyone wanting background information, since I’ve been scolded
by a Xilinx forum moderator for offering too many links to my blog and <a href="/projects.html">my
github IP</a>.  Specifically, I’ve been told me
to keep the hyper-links in my forum replies at two or less.  The reply quoted
below originally had only the one link within it.</p>

<h2 id="my-response">My Response</h2>

<p>If you read through the forums, you’ll see that this [<a href="https://forums.xilinx.com/t5/user/viewprofilepage/user-id/74556">u4223374</a>’s]
view doesn’t hold water.</p>

<p>A very common question is, “Why doesn’t my design work?”  This question is
asked over and over, from those who have tried this approach, understand none
of what’s going on under the hood, and then <a href="/blog/2017/05/19/fpga-hell.html">can’t figure out what’s wrong with
their design</a> when it doesn’t
work.  They are forever posting here [on <a href="https://forums.xilinx.com">Xilinx’s
forums</a>] needing to be rescued, unable to <a href="/digilent/2017/05/29/fft-debugging.html">narrow
down the problem to the component at fault</a>,
and so they tend to blame Xilinx’s cores of not working when it is their
own code at fault.</p>

<p>While not always the case, it doesn’t help when the code block they are using
<a href="/formal/2018/12/28/axilite.html">actually has bugs in it already</a>.  Worse, because the beginner is never taught
the fundamentals, but rather the idea that digital design is just like
connecting Legos, they have <a href="/blog/2017/05/19/fpga-hell.html">no idea where to even
start</a> when trying to find
the problem.</p>

<p>The problem gets worse for the designer who wants to make use of older hardware,
hardware that might no longer be supported by Xilinx.  Equivalenty, FPGA design
is often seen as a gateway to ASIC design.  If all you learn is how to connect
pre-built Lego blocks, you’re not likely to get a job where you actually need
to build something to sell.</p>

<p><a href="https://en.wikipedia.org/wiki/High-level_synthesis">HLS</a> was designed to make
HDL even easier.  From what I’ve seen, it only makes HDL design easier <em>for
the individual who already understands HDL design</em> in the first place.  Many
students I know who’ve tried it
[<a href="https://en.wikipedia.org/wiki/High-level_synthesis">HLS</a>]
have noted that small, subtle, and seemingly insignificant code changes will
take a “working” design and render it non-synthesizable.</p>

<p>As to the recommendation from the original author,</p>

<blockquote>
  <p>I would suggest if you have no hands on experience and aren’t really itching
to see sometimes [sic] happen in a circuit that you can focus on learning
your HDL of choice and learn to write test benches to validate your designs.</p>
</blockquote>

<p>I would agree somewhat, but with caveats based upon the mistakes I’ve seen
students make who have followed this recommendation.</p>

<ul>
  <li>
    <p>I’ve seen students confuse test-bench only code, code that cannot be
synthesized, with synthesizable code.  Often students don’t even know the
difference after starting from this standpoint.</p>
  </li>
  <li>
    <p>I’ve also seen <a href="/zipcpu/2017/12/28/ugliest-bug.html">way too many bugs pass bench tests, only to fail in real
hardware</a>.   (This
includes first and foremost my own bugs …)</p>
  </li>
</ul>

<p>This leaves me with two additional recommendations:</p>

<ol>
  <li>
    <p>A beginner needs to learn how to <a href="/blog/2017/06/02/design-process.html">debug their design in
hardware</a> as well as
with the test bench–especially if his design hits hardware after only ever
seeing a testbench.  (Yes, there is a <a href="/blog/2017/10/19/formal-intro.html">better
way</a>.)</p>
  </li>
  <li>
    <p>I recommend using the synthesizer along the way.  Even if the student doesn’t
have any real hardware, it is possible to use a synthesizer to 1) recognize
unsynthesizable code, and 2) discover what kinds of code can be synthesized
within any particular clock speed and what kinds cannot.</p>
  </li>
  <li>
    <p>Even better, a beginner should learn to use <a href="/blog/2017/10/19/formal-intro.html">formal
methods</a>.</p>

    <p>Why?</p>

    <p>Because <a href="/blog/2017/10/19/formal-intro.html">formal
methods</a> do a better
job of finding bugs than test benches alone</p>
  </li>
</ol>

<p>Since I believe so firmly in this approach, I’ve put together a <a href="/tutorial">tutorial for
beginners</a>.  It’s a hardware agnostic tutorial,
so you should be able to learn regardless of what hardware you have as long
as 1) You have a serial port, 2) a button, and 3) A couple of LEDs.</p>

<h2 id="why-would-xilinx-delete-this-comment">Why would Xilinx delete this comment?</h2>

<p>I think Xilinx is working very hard to sell the idea that hardware design is
as simple as playing with Legos: Connect this block to that block and Voila!
Magically a working design appears.  While (I hope) that this is often the
case for those who use this approach, I have a different perspective: I tend
to read the forum posts that were written by those for whom this simplified
design methodology doesn’t work.  (You might argue that my
sampling <a href="https://en.wikipedia.org/wiki/Universe_(mathematics)">Universe</a>
is skewed as a result.)</p>

<p>I also tend to be rather hard on Xilinx for the bugs in their example AXI
designs–those that they recommend beginners start from.
[<a href="/formal/2018/12/28/axilite.html">1</a>]
[<a href="/formal/2019/05/13/axifull.html">2</a>]  Sadly, these faulty
designs have caused a lot of problems for Xilinx’s users:</p>

<ol>
  <li>
    <p>One software engineer picked up from where the hardware engineer left
off–after the hardware engineer “finished” the project, delivered a
“working” design, and left the company …  This software engineer made
a very minor adjustment to his MicroBlaze code and the FPGA portion of his
design stopped working.  A key feature of his new design was a pair of
adjacent store instructions just before the design failed.  This could’ve
been caused by either of the bugs I had found in their training material
(cited above).</p>
  </li>
  <li>
    <p>Several other users have been frustrated that Xilinx’s AXI DMA core has
“caused” their design to hang.  They’ve asked how to “reset” the core, so
they can go on.</p>

    <p>The problem here is important: AXI, by design, cannot recover from dropped
transactions.  If the master is no longer interested in the bus response,
it has no way to drop the response without resetting the entire bus or just
ignoring the response.</p>

    <p>In the bugs I demonstrated above, transaction responses would get dropped
in their demo code.  This will cause the design (and the attached bus) to
hang–unable to be reset until a power cycle.</p>

    <p>One solution to this problem is to use a wrapper core with some kind of
safety feature: Xilinx offers what they call an “AXI firewall” IP to check
for AXI failures and set a flag that the ILA might notice.  Of course, that
IP would be forever broken until the next reset (i.e. power cycle).  An
alternative approach is to use my own <a href="https://github.com/ZipCPU/wb2axip/blob/master/rtl/axisafety.v">bus fault
isolator</a>,
and to configure it to reset the downstream peripheral once any error is
detected.  Sadly, while these two approaches will allow you to recover from
a fault, it may well be that a faulty core doesn’t trigger either of the
tests within these cores.  I know from my own experience, that <a href="https://github.com/ZipCPU/wb2axip/blob/master/rtl/axisafety.v">the logic
within my own core</a>,
simplifies (and slows down) the AXI transaction, and so there’s a non-zero
likelihood that this might prevent a design from failing downstream of
this fault isolator.</p>
  </li>
  <li>
    <p>It’s not that uncommon for an engineer to post to the forum, declare
Xilinx’s code is broken, but then refuse to share his own code.</p>

    <p>In many of these examples, I’ve asked if users will post their code so that
I can test my formal properties on their core.  While some have taken me
up on the offer, there haven’t been that many takers.  Of those who have
taken me up on the offer, verifying the code is often quite easy: since most
Xilinx users copy from Xilinx’s demo designs.  As a result, the proof is
usually as simple as one of the ones I’ve done before.  Of those who haven’t
posted their code, some have at least posted traces showing <a href="/formal/2019/04/16/axi-mistakes.html">dropped
acknowledgements</a>.</p>
  </li>
  <li>
    <p>There are “right” and “wrong” answers to this kind of criticism.  The
<a href="https://www.blueletterbible.org/kjv/jhn/3/21">“right” response</a> is to
1) acknowledge the problem (Yes, it’s broken), 2) identify
the problem (it does this when it should do that, it’s been broken since
2016 or whenever), 3) promise a fix, and then 4) announce when the
demonstration code works again again.  Finally, they should 5) point out to
users who might not know of the problem, that a fix has been issued.</p>

    <p>Were they to do this, I’d either get quiet or repeat the corporate message.
Up until now, Xilinx’s has been (nearly) silent on this topic.</p>

    <p>Not commenting is one thing, but … deleting posts?</p>

    <p>Sadly, getting rid of the messenger doesn’t change the truth of the message.
It also leaves those who desire to build reliable designs in a lurch, since
they still don’t know why their designs are failing.</p>
  </li>
</ol>

<p>At a glance, the problem is simply this: When a newcomer comes to the Xilinx
forums to ask <a href="/blog/2019/05/29/demoaxi.html">how to build an AXI
design</a>, the official answer
is to point him to the demo designs.  Sadly, when I pointed one such user to
the bugs in Xilinx’s demonstration designs, they were quite disheartened.</p>

<blockquote>
  <p>Thank you, Dan, but I need something easier. …</p>
</blockquote>

<p>My response below helps to highlight the core issue:</p>

<blockquote>
  <p>In many ways, it’s a shame Xilinx chose AXI as their protocol for connecting
everything together.  AXI is a very complicated protocol, and a hard one to
get right.  I like to use
<a href="/zipcpu/2017/11/07/wb-formal.html">Wishbone</a>, and find it
much easier to work with.  There’s also an AHB protocol that’s easier to work
with than <a href="/zipcpu/2017/11/07/wb-formal.html">Wishbone</a>.</p>

  <p>That said, I really don’t know any way to make this “easy” as you would like.
The complexity comes with the territory.</p>
</blockquote>

<p>Sorry, folks, but we’re not building Legos here.  If you want things to work,
and to reliably work well, then you need to learn the fundamentals.  Second,
if you want to build <a href="/blog/2019/05/29/demoaxi.html">AXI interfaces with
confidence</a>, you need <a href="/formal/2018/12/28/axilite.html">formal
methods</a>.
Neither Xilinx’s test benches, nor their Verification IP, found the bugs
I’ve blogged about that many users have been struggling with and from.</p>

  </div>


<div class "verse">
<HR align="center;" width="25%">
<P><em>What I tell you in darkness, that speak ye in light: and what ye hear in the ear, that preach ye upon the housetops.  (Matt 10:27)</em>


</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">The ZipCPU by Gisselquist Technology</h2>
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <!-- <li></li> -->
          <li><a href="mailto:zipcpu@gmail.com">zipcpu@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="soc-medlist">
          
          <li>
            <a href="https://github.com/ZipCPU"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">ZipCPU</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/zipcpu"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">@zipcpu</span></a>

          </li>
          
          
          <li><A href="https://www.patreon.com/ZipCPU"><img src="/img/become_a_patron_button.png"></a></li>
          

        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>The ZipCPU blog, featuring how to discussions of FPGA and soft-core CPU design.  This site will be focused on Verilog solutions, using exclusively OpenSource IP products for FPGA design.  Particular focus areas include topics often left out of more mainstream FPGA design courses such as how to debug an FPGA design.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
