<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>A fun Friday evening--verifying an AXI-lite slave</title>
  <meta name="description" content="On a whim, at the end of a long week, I decided to try something new yesterday.I decided to try to verify an AXIdesignin front of others.  My goal was to do ...">

  <link rel="shortcut icon" type="image/x-icon" href="/img/GT.ico">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://zipcpu.com/formal/2020/10/17/friday.html">
  <link rel="alternate" type="application/rss+xml" title="The ZipCPU by Gisselquist Technology" href="https://zipcpu.com/feed.xml">
</head>


  <body>

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4ZK7HKHSVW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4ZK7HKHSVW');
</script>

    <header class="site-header">
  <div id="banner">
  <a href="/"><picture>
    <img height=120 id="site-logo" src="/img/fullgqtech.png" alt="Gisselquist Technology, LLC">
  </picture></A>
  </div>

  <div class="site-nav">
<ul>

<li><a HREF="/">Main/Blog</a>


<li><a HREF="/about/">About Us</a>


<li><a HREF="/fpga-hell.html">FPGA Hell</a>


<li><a HREF="/tutorial/">Tutorial</a>
<li><a HREF="/tutorial/formal.html">Formal training</a>


<li><a HREF="/quiz/quizzes.html">Quizzes</a>


<li><a HREF="/projects.html">Projects</a>


<li><a HREF="/topics.html">Site Index</a>

<HR>

<li><a href="https://twitter.com/zipcpu"><span class="icon--twitter"><svg viewBox="0 0 400 400"><path fill="#1da1f2" d="M153.62,301.59c94.34,0,145.94-78.16,145.94-145.94,0-2.22,0-4.43-.15-6.63A104.36,104.36,0,0,0,325,122.47a102.38,102.38,0,0,1-29.46,8.07,51.47,51.47,0,0,0,22.55-28.37,102.79,102.79,0,0,1-32.57,12.45,51.34,51.34,0,0,0-87.41,46.78A145.62,145.62,0,0,1,92.4,107.81a51.33,51.33,0,0,0,15.88,68.47A50.91,50.91,0,0,1,85,169.86c0,.21,0,.43,0,.65a51.31,51.31,0,0,0,41.15,50.28,51.21,51.21,0,0,1-23.16.88,51.35,51.35,0,0,0,47.92,35.62,102.92,102.92,0,0,1-63.7,22A104.41,104.41,0,0,1,75,278.55a145.21,145.21,0,0,0,78.62,23"/></svg>
</span><span class="username">@zipcpu</span></a>

<li><a href="https://www.reddit.com/r/ZipCPU"><span class="username">Reddit</a>
<li><a HREF="https://www.patreon.com/ZipCPU"><IMG SRC="/img/patreon_logomark_color_on_white.png" WIDTH="25"> Support</a>
</ul>
</div>


</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="https://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">A fun Friday evening--verifying an AXI-lite slave</h1>
    <p class="post-meta"><time datetime="2020-10-17T00:00:00-04:00" itemprop="datePublished">Oct 17, 2020</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>On a whim, at the end of a long week, I decided to try something new yesterday.
I decided to try to verify an <a href="https://github.com/olofk/axi_node/blob/master/axi_node.sv">AXI
design</a>
in front of others.  My goal was to do something fun and perhaps to have a
little excitement.</p>

<table align="center" style="float: right"><tr><td><img src="/img/friday/happyhour.jpg" alt="" width="300" /></td></tr></table>

<p>Sadly, one of the challenges of writing blog articles about formal verification
is that few people realize how easy it actually is.  They just look at the
article, figure it was a fun read, or perhaps that I as an author am an amazing
verification engineer.  What you don’t realize is that a lot of these things
can be done in just minutes, while saving you weeks of heartache trying to
debug something in hardware.</p>

<p>So, I started out with a tweet yesterday morning asking if anyone would want
to see what it takes to formally verify a AXI-based design, and whether or not
any one had a design they wished to share.</p>

<table align="center" style="float: none"><tr><td><img src="/img/friday/tweet.png" alt="" width="547" /></td></tr></table>

<p>Many individuals indicated their interest in watching me verify a design, but
no one offered a sacrificial design.  So I went looking for a design with an
AXI interface that could be verified publicly.</p>

<p>I first checked the Vivado sources that come with the install.  One of the fun
things about Vivado is that it comes with so much IP.  Much of this IP is in
VHDL.  VHDL wouldn’t be ideal, since it requires the commercial version of
<a href="https://symbiyosys.readthedocs.io/en">SymbiYosys</a>, but its not out of the question thanks to the Symbiotic EDA team
who have provided me with a copy to work with.  Even better, I have a bit of
experience verifying Vivado IP, so I know the basic steps.  In the past
I’ve looked at their AXI-APB bridge, AHB-lite to AXI bridge,
<a href="https://www.xilinx.com/products/intellectual-property/axi_ethernetlite.html">AXI-ethernet lite</a>,
<a href="https://www.xilinx.com/products/intellectual-property/axi_gpio.html">AXI GPIO</a>,
and <a href="https://www.xilinx.com/products/intellectual-property/axi_lite_ipif.html">AXI IPIF</a> logic cores.  I’ve also verified their demonstration
designs for AXI master, <a href="/formal/2019/05/13/axifull.html">AXI
slave</a>, AXI-lite master,
<a href="/formal/2018/12/28/axilite.html">AXI-lite slave</a>, and their
AXI-stream master.  Several of these designs have nice bugs that are fun
to find with <a href="https://symbiyosys.readthedocs.io/en">SymbiYosys</a>.</p>

<p>In the end, this didn’t pan out.  My problem was that I didn’t want to just
show a previously verified design and talk to it.  That’s boring.  There’s no
excitement in it.  The conclusion is already well known.  Instead, I wanted
to show the process as it happened–so folks could see how fast and
easy this is to do, and watch in real time to see what (if any) struggles I had.
As a result, I needed something new to verify.</p>

<p>My first thought was to try <a href="https://www.xilinx.com/products/intellectual-property/axi-firewall.html">Xilinx’s AXI
firewall</a>.
This would be an ideal AXI core, since there was no more interface to it other
than AXI that I might get wrong.  Sadly, this depended upon an encrypted
<code class="language-plaintext highlighter-rouge">sc_util*</code> package, so I had to move on and keep looking.</p>

<p>I next thought about verifying <a href="https://www.xilinx.com/products/intellectual-property/axi-amm-bridge.html">Xilinx’s Avalon to AXI
bridge</a>.
This would also be pretty easy to verify, since I already have bus property
files for both
<a href="https://github.com/ZipCPU/wb2axip/blob/master/bench/formal/fav_slave.v">Avalon</a>
and AXI.  Unfortunately, this depended upon their (encrypted) datamover IP,
so I moved on again.</p>

<p>I also put some time into their <a href="https://www.xilinx.com/products/intellectual-property/axi_timer.html">AXI timer
package</a>.
Surely this one would be simple enough for a basic demonstration, no?
No.  Sadly, for some reason, I
wasn’t able to get the VHDL packages read into Yosys properly.  I’m not quite
sure what the problem was.  Perhaps with a bit more work at it this might turn
into a nice example later on, but I didn’t want to spend my day solving this
problem–I was actually trying to do other work at the time.</p>

<p>I then turned to <a href="https://duckduckgo.com">duckduckgo</a>, and searched for open
source AXI interconnects.  Interconnects have two well defined interfaces,
AXI slave interfaces and AXI master interfaces, to which I should be able
to attach formal slave and master bus property files.  I then found <a href="https://github.com/olofk/axi_node">this
repository</a>, having an <a href="https://github.com/olofk/axi_node/blob/master/axi_node.sv">open source AXI
interconnect</a>
within it.  Sadly, <a href="https://github.com/olofk/axi_node/blob/master/axi_node.sv">this
interconnect</a> was
run-time configurable.  While such a programmable interconnect can certainly
be verified, I would need to provide several assumptions to make certain it
was programmed properly before expecting good behavior from it.  For example,
you don’t want to allow two master interfaces to be controlled from the
same address range.</p>

<p>Not knowing quite how to handle this, I looked for any other designs in the
<a href="https://github.com/olofk/axi_node">same repository</a>, and came across this
<a href="https://github.com/olofk/axi_node/blob/master/axi_regs_top.sv">axi_regs_top.sv</a>
AXI slave.  Having been burned trying to get Xilinx’s designs into Yosys, I
just double checked that Yosys could parse it.  The open source version came
close, but it ended up struggling at the <a href="https://github.com/olofk/axi_node/blob/0193125be350718e7fe8b44308f4dc44749ef60c/axi_regs_top.sv#L132-L141">three dimensional
ports</a>
used by the design.  However, the commercial version of Yosys that comes with
the SymbioticEDA Suite could parse it just fine.  Therefore, I figured this
design might have some verification potential.</p>

<p>Again, my goal was to find a design which could be verified while others
watched, to show how easy the process can be.  So while I might still come
back to any of these designs and put some more work into them, I was just
looking for a quick demonstration that might be fun to share.</p>

<p>At this point, I tweeted my intentions and set up a Zoom meeting room for
anyone who might want to join.</p>

<table align="center" style="float: none"><tr><td><img src="/img/friday/invite.png" alt="" width="568" /></td></tr></table>

<p>Having never seen <a href="https://github.com/olofk/axi_node/blob/0193125be350718e7fe8b44308f4dc44749ef60c/axi_regs_top.sv">the design</a>
before, I wasn’t certain if it would have any
bugs in it or not.  Therefore, this was far from a canned demonstration.
Worse, from a business standpoint, I was doing this all wrong: I didn’t
take down any contact information, register participants, ask for market
surveys, any of that.  I didn’t even dress up in a suit or tie.  That’s
okay, I suppose, I mean … I wasn’t getting paid for this, and I’m already
quite loaded on customers at this point.  My goal was just to have a bit of fun.</p>

<h2 id="verifying-the-design">Verifying the design</h2>

<p>The Zoom chat started at 5pm local (Eastern) time.  About a dozen individuals
joined to watch.  Yes, I’ll admit, I was kind of worried that no one would
show up.  The whole “event”, if you want to call it that, was set up with
three hours notice.  I’m sure more folks might have attended if they would’ve
had more notice.  My apologies to anyone who may have felt cheated out of a
great opportunity–I was just out for some fun and perhaps to gauge a bit of
interest.  Was this something worth doing at all?  Would it be something I
enjoyed?  If so, perhaps I should do it again.  If not, oh well, at least
I would’ve had a fun evening.</p>

<p>But for now, let’s turn our attention to the task at hand.</p>

<p>If you’ve never <a href="/formal/2018/12/28/axilite.html">verified an AXI-lite
slave</a> before, it’s
not that hard at all.  There were just a couple of quick steps we went through.</p>

<p>The first step was to instantiate a copy of <a href="https://github.com/ZipCPU/wb2axip/blob/master/bench/formal/faxil_slave.v">my AXI-lite slave
properties</a>
within the design.  This consisted primarily of just a lot of typing.</p>

<figure class="highlight"><pre><code class="language-verilog" data-lang="verilog"><span class="cp">`ifdef</span>	<span class="n">FORMAL</span>
	<span class="k">localparam</span>	<span class="n">F_LGDEPTH</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

	<span class="kt">wire</span>	<span class="p">[</span><span class="n">F_LGDEPTH</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>	<span class="n">faxil_rd_outstanding</span><span class="p">;</span>
	<span class="kt">wire</span>	<span class="p">[</span><span class="n">F_LGDEPTH</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>	<span class="n">faxil_wr_outstanding</span><span class="p">;</span>
	<span class="kt">wire</span>	<span class="p">[</span><span class="n">F_LGDEPTH</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>	<span class="n">faxil_awr_outstanding</span><span class="p">;</span>
	
	<span class="n">faxil_slave</span> <span class="p">#(</span>
		<span class="p">.</span><span class="n">C_AXI_ADDR_WIDTH</span><span class="p">(</span><span class="n">C_S_AXI_ADDR_WIDTH</span><span class="p">),</span>
		<span class="p">.</span><span class="n">C_AXI_DATA_WIDTH</span><span class="p">(</span><span class="n">C_S_AXI_DATA_WIDTH</span><span class="p">),</span>
		<span class="p">.</span><span class="n">F_LGDEPTH</span><span class="p">(</span><span class="n">F_LGDEPTH</span><span class="p">)</span>
	<span class="p">)</span> <span class="n">faxil</span> <span class="p">(</span>
		<span class="p">.</span><span class="n">i_clk</span><span class="p">(</span><span class="n">s_axi_aclk</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_reset_n</span><span class="p">(</span><span class="n">s_axi_aresetn</span><span class="p">),</span>
		<span class="c1">//</span>
		<span class="p">.</span><span class="n">i_axi_awready</span><span class="p">(</span><span class="n">s_axi_awready</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_awaddr</span><span class="p">(</span><span class="n">s_axi_awaddr</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_awvalid</span><span class="p">(</span><span class="n">s_axi_awvalid</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_awprot</span><span class="p">(</span><span class="mh">3'h0</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_awcache</span><span class="p">(</span><span class="mh">4'h0</span><span class="p">),</span>
		<span class="c1">//</span>
		<span class="p">.</span><span class="n">i_axi_wready</span><span class="p">(</span><span class="n">s_axi_wready</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_wdata</span><span class="p">(</span><span class="n">s_axi_wdata</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_wstrb</span><span class="p">(</span><span class="n">s_axi_wstrb</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_wvalid</span><span class="p">(</span><span class="n">s_axi_wvalid</span><span class="p">),</span>
		<span class="c1">//</span>
		<span class="p">.</span><span class="n">i_axi_bready</span><span class="p">(</span><span class="n">s_axi_bready</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_bvalid</span><span class="p">(</span><span class="n">s_axi_bvalid</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_bresp</span><span class="p">(</span><span class="n">s_axi_bresp</span><span class="p">),</span>
		<span class="c1">//</span>
		<span class="p">.</span><span class="n">i_axi_araddr</span><span class="p">(</span><span class="n">s_axi_araddr</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_arvalid</span><span class="p">(</span><span class="n">s_axi_arvalid</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_arready</span><span class="p">(</span><span class="n">s_axi_arready</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_arprot</span><span class="p">(</span><span class="mh">3'h0</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_arcache</span><span class="p">(</span><span class="mh">4'h0</span><span class="p">),</span>
		<span class="c1">//</span>
		<span class="p">.</span><span class="n">i_axi_rvalid</span><span class="p">(</span><span class="n">s_axi_rvalid</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_rready</span><span class="p">(</span><span class="n">s_axi_rready</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_rdata</span><span class="p">(</span><span class="n">s_axi_rdata</span><span class="p">),</span>
		<span class="p">.</span><span class="n">i_axi_rresp</span><span class="p">(</span><span class="n">s_axi_rresp</span><span class="p">),</span>
		<span class="c1">//</span>
		<span class="p">.</span><span class="n">f_axi_rd_outstanding</span><span class="p">(</span><span class="n">faxil_rd_outstanding</span><span class="p">),</span>
		<span class="p">.</span><span class="n">f_axi_wr_outstanding</span><span class="p">(</span><span class="n">faxil_wr_outstanding</span><span class="p">),</span>
		<span class="p">.</span><span class="n">f_axi_awr_outstanding</span><span class="p">(</span><span class="n">faxil_awr_outstanding</span><span class="p">)</span>
	<span class="p">);</span>
<span class="cp">`endif</span></code></pre></figure>

<p>I then I built a quick SBY file to configure
<a href="https://symbiyosys.readthedocs.io/en">SymbiYosys</a>.</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">[tasks]
prf
cvr

[options]
prf: mode prove
prf: depth 4
cvr: mode cover
cvr: depth 40

[engines]
smtbmc

[script]
read -formal axi_regs_top.sv
read -formal faxil_slave.v
prep -top axi_regs_top

[files]
axi_regs_top.sv
faxil_slave.v</code></pre></figure>

<p>If I recall correctly, this only took about 20-30 minutes, and it was mostly
typing and boilerplate.  I might’ve been able to go even faster if I wasn’t
explaining what I was doing, but I was enjoying sharing and so I took my time
to make certain that I explained what was going on and why I was doing what
I was doing.</p>

<p>The first run took only 16 seconds from start to fail.  It produced the trace
shown in Fig. 1 below.</p>

<table align="center" style="float: none"><caption>Fig 1. Initial trace from formal</caption><tr><td><a href="/img/friday/async-reset-bvalid-annotated.png"><img src="/img/friday/async-reset-bvalid-annotated.png" alt="" width="780" /></a></td></tr></table>

<p>The “problem” the formal tools found is that <code class="language-plaintext highlighter-rouge">BVALID</code> is raised and then lowered
while the <code class="language-plaintext highlighter-rouge">B*</code> channel is stalled.  This suggests that a packet might’ve been
dropped–until you look closer that is.</p>

<p>The actual problem is that this particular design uses an asynchronous reset.
Did you notice how the reset was asserted the same cycle that <code class="language-plaintext highlighter-rouge">BVALID*</code> dropped?
For many designers, this isn’t a bug but a feature or perhaps even a
requirement.  From my standpoint, this is a setup problem: I hadn’t enabled
asynchronous reset checking in the <a href="https://github.com/ZipCPU/wb2axip/blob/master/bench/formal/faxil_slave.v">formal property
file</a>.
This was easily fixed,</p>

<figure class="highlight"><pre><code class="language-verilog" data-lang="verilog">	<span class="n">faxil_slave</span> <span class="p">#(</span>
		<span class="c1">// ...</span>
		<span class="p">.</span><span class="n">F_OPT_ASYNC_RESET</span><span class="p">(</span><span class="mb">1'b1</span><span class="p">),</span>
		<span class="c1">// ...</span>
	<span class="p">)</span> <span class="n">faxil</span> <span class="p">(</span>
		<span class="c1">// ...</span></code></pre></figure>

<p>and so I re-ran the proof.</p>

<p>Re-running the proof a second time turned up another problem: The design
didn’t keep <code class="language-plaintext highlighter-rouge">RDATA</code> from changing while the <code class="language-plaintext highlighter-rouge">R*</code> channel was supposed to be
stalled.  While it would be fun to declare the job done at this point
now that I had found the first bug, honesty isn’t that easy.  As an engineer,
I need to know if the design I’m verifying is broken, or if instead somehow my
test setup is broken.  Therefore, any failing trace needs to be investigated.
Perhaps this was just another setup bug like the asynchronous reset bug above.</p>

<p>Not this time.</p>

<p>In this case, it was a real bug, and I stumbled across what was going on
when collapsing the AXI write channel view for a view of the AXI read channel:
a register, controlled by the design, was being written to while the read
channel was stalled.  Since the design never latched read results but instead
always produced the current value of the register being read–there was no
protection against this fault.</p>

<table align="center" style="float: none"><caption>Fig 2. RDATA changes when the read return channel should be stalled</caption><tr><td><a href="/img/friday/rdata-bug-annotated.png"><img src="/img/friday/rdata-bug-annotated.png" alt="" width="780" /></a></td></tr></table>

<p>Having now found a first fault, I made an assumption that this would never
happen again.  Such an assumption has the unfortunate consequence of
potentially hiding other failures,
so you always have to be careful when doing this and to document it well.</p>

<figure class="highlight"><pre><code class="language-verilog" data-lang="verilog">	<span class="c1">// BUG #1: AXI_RDATA might change when stalled</span>
	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="kt">posedge</span> <span class="n">s_axi_aclk</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s_axi_aresetn</span> <span class="o">&amp;&amp;</span> <span class="p">$</span><span class="nb">past</span><span class="p">(</span><span class="n">s_axi_rvalid</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">s_axi_rready</span><span class="p">))</span>
		<span class="k">assume</span><span class="p">($</span><span class="nb">stable</span><span class="p">(</span><span class="n">s_axi_rdata</span><span class="p">));</span></code></pre></figure>

<p>Here I documented it as bug #1 within the source.</p>

<p>I also try to place all assumptions like this at a known place, in a block
at the end of the file, so I know where to find them when I come back to the
design later.  I label this block as “careless assumptions”, simply because
they artificially constrain the proof in a way that may match reality.</p>

<p>I then ran <a href="https://symbiyosys.readthedocs.io/en">SymbiYosys</a> again a third
time.  This time, however, after over ten minutes, Yosys hadn’t found any
bugs in a bounded model check of perhaps 8-10 steps.  It was time to switch to
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>.</p>

<table align="center" style="float: right"><caption>Fig 3. Only an inductive proof can verify a design for all time</caption><tr><td><img src="/img/friday/induction-results.png" alt="" width="417" /></td></tr></table>

<p>For those who might not know, <a href="/formal/2020/06/12/four-keys.html">I am a real
fan</a> of
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>.  I like
it a lot.  While a bounded model check can find problems in a <em>bounded</em> number
of steps (only 8-10 timesteps so far), it can never prove that your design
works for all time.  Only
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>
can do that.  Not only that, but some errors can only be found using
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>:
counter overflows, buffer overruns, timeouts, and so forth.  These are
important, so whenever possible I like to use
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>.</p>

<table align="center" style="float: right"><caption>Fig 4. Induction can begin a design in an unreachable state</caption><tr><td><img src="/img/formal-induction.svg" alt="" width="320" /></td></tr></table>

<p>The <a href="/blog/2018/03/10/induction-exercise.html">problem with
induction</a>
is that the
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>
engine can start your design
in an unreachable state–one where the various registers within the design
aren’t consistent.  The engine might then go from there to breaking some
assertion or other that would never be broken in real life.</p>

<p>I like to describe this concept using the blobology shown in Fig. 4.  The green
set of states are those which you want the design to reside within.  The
red blob are those states that are made illegal by assertions.  The
unbounded white area surrounding the entire design is made illegal by
assumptions.  That leaves the bounded yellow area.  Yellow describes states
your design can never get into.  You normally don’t care about these
states–you’ll never reach them via
<a href="/blog/2018/08/22/what-is-simulation.html">simulation</a>.  Not
so with <a href="/blog/2018/03/10/induction-exercise.html">induction</a>.
The <a href="/blog/2018/03/10/induction-exercise.html">induction</a>
engine might <em>start</em> your design from one of these states, and then proceed
to a state that you have specifically asserted is not possible.</p>

<table align="center" style="float: left; padding: 20px"><caption>Fig 5. Solving the induction problem</caption><tr><td><img src="/img/formal-induction-soln.svg" alt="" width="320" /></td></tr></table>

<p>The solution to this problem comes from adding more assertions to the
design–enough to eliminate the yellow unreachable area.  These assertions will
then keep the
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>
engine from starting out in such an unreachable state.  The
problem, though, is when you are looking at a design that isn’t yours: what
assertions should you add?</p>

<p>To answer that question, I turned to <code class="language-plaintext highlighter-rouge">cover()</code>.  The first pass with cover
wasn’t what I wanted: it just covered one read return or one write return.
So I went back to the formal property file and added in the <code class="language-plaintext highlighter-rouge">F_OPT_COVER_BURST</code>
option–setting it to find the first trace containing four writes as well
as the first trace containing four reads.</p>

<figure class="highlight"><pre><code class="language-verilog" data-lang="verilog">	<span class="n">faxil_slave</span> <span class="p">#(</span>
		<span class="c1">// ...</span>
		<span class="p">.</span><span class="n">F_OPT_COVER_BURST</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
		<span class="c1">// ...</span>
	<span class="p">)</span> <span class="n">faxil</span> <span class="p">(</span>
		<span class="c1">// ...</span></code></pre></figure>

<p><a href="https://github.com/ZipCPU/wb2axip/blob/93565afffbe00da17e5f126137daaeb482bdd520/bench/formal/faxil_slave.v#L768-L802">The logic required to make this happen is nothing more than a basic counter,
and so it hardly needs further
mentioning</a>.</p>

<p>The fact that <code class="language-plaintext highlighter-rouge">cover()</code> returns the first potential trace is important, because
it means you can use <code class="language-plaintext highlighter-rouge">cover()</code> to measure throughput as well.  That comes for
free.  In my case, I just wanted to see everything that took place within
<a href="https://github.com/olofk/axi_node/blob/0193125be350718e7fe8b44308f4dc44749ef60c/axi_regs_top.sv">the core</a>
between one read or write request and the next.  The throughput
measure was simply an added bonus on top.</p>

<p>You can see the trace generated to cover burst reads in Fig. 6, below.</p>

<table align="center" style="float: none"><caption>Fig 6. A Cover trace showing four reads in rapid succession</caption><tr><td><a href="/img/friday/cvr-reads.png"><img src="/img/friday/cvr-reads.png" alt="" width="780" /></a></td></tr></table>

<p>As you can see, it takes this core four cycles from one read request
until it can accept the next one at its maximum speed.</p>

<p>I first chose to examine the read side, to see what was happening on each of
these four clock cycles.  On the first clock cycle the read was accepted,
then there was an internal cycle to process the read, then <code class="language-plaintext highlighter-rouge">RVALID</code> was set,
cleared, and then finally <code class="language-plaintext highlighter-rouge">ARREADY</code> was set to allow a subsequent transaction.
While this is far from high speed, this wasn’t my own design–I was just
looking for AXI bugs.  If you want a better design, use my <a href="/blog/2020/03/08/easyaxil.html">easy AXI-lite
design</a>
as a starting point.</p>

<p>Incidentally, if you want a better AXI (not lite) design, you can either use <a href="/blog/2019/05/29/demoaxi.html">my
AXI slave</a> as a starting point
or, if you’d rather work with AXI-lite, you can also start with <a href="https://github.com/ZipCPU/wb2axip/blob/master/rtl/axi2axilite.v">my AXI to
AXI-lite bridge</a>.
<a href="https://github.com/ZipCPU/wb2axip/blob/master/rtl/axi2axilite.v">That bridge</a>
will feed an
<a href="/blog/2019/01/12/demoaxilite.html">AXI-lite design</a>
with 100% throughput–allowing you to get full AXI performance from an
AXI-lite interface.  The cost?  Two extra clock cycles and some buffers.
Still, it’s quite usable.  But … I digress.</p>

<p>Looking through the design, the first thing I noticed was that the design never
allowed more than one transaction to be outstanding at a time.  That’s
easy to enforce, by just using the transaction counters from the
<a href="/formal/2018/12/28/axilite.html">formal AXI-lite properties</a>.</p>

<figure class="highlight"><pre><code class="language-verilog" data-lang="verilog">	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">(</span><span class="n">faxil_awr_outstanding</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">(</span><span class="n">faxil_wr_outstanding</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">(</span><span class="n">faxil_rd_outstanding</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">);</span></code></pre></figure>

<p>Looking a bit further, I found some <code class="language-plaintext highlighter-rouge">*done_reg</code> signals that looked related
to the read channel’s processing.  If you plot these signals out, you can
see a basic relationship between them–as shown at the bottom of the trace
in Fig. 6 above.</p>

<p>I quickly turned these relationships into a couple of assertions.</p>

<figure class="highlight"><pre><code class="language-verilog" data-lang="verilog">	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s_axi_aresetn</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">((</span><span class="n">araddr_done_reg</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">rresp_done_reg</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">faxil_rd_outstanding</span> <span class="o">==</span> <span class="mi">1</span><span class="p">));</span>

	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s_axi_aresetn</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">(</span><span class="n">araddr_done_reg</span> <span class="o">||</span> <span class="o">!</span><span class="n">rresp_done_reg</span><span class="p">);</span>

	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s_axi_aresetn</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">(</span><span class="n">araddr_done_reg</span> <span class="o">==</span> <span class="o">!</span><span class="n">s_axi_arready</span><span class="p">);</span></code></pre></figure>

<p>I then turned around and repeated this process on the write side of the
interface.</p>

<figure class="highlight"><pre><code class="language-verilog" data-lang="verilog">	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s_axi_aresetn</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">(</span><span class="n">awaddr_done_reg</span> <span class="o">==</span> <span class="o">!</span><span class="n">s_axi_awready</span><span class="p">);</span>

	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s_axi_aresetn</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">(</span><span class="n">wdata_done_reg</span> <span class="o">==</span> <span class="o">!</span><span class="n">s_axi_wready</span><span class="p">);</span>

	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s_axi_aresetn</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">((</span><span class="n">awaddr_done_reg</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">wresp_done_reg</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">faxil_awr_outstanding</span> <span class="o">==</span> <span class="mi">1</span><span class="p">));</span>

	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s_axi_aresetn</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">((</span><span class="n">wdata_done_reg</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">wresp_done_reg</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">faxil_wr_outstanding</span> <span class="o">==</span> <span class="mi">1</span><span class="p">));</span>

	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">wresp_done_reg</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">(</span><span class="n">wdata_done_reg</span> <span class="o">&amp;&amp;</span> <span class="n">awaddr_done_reg</span><span class="p">);</span></code></pre></figure>

<p>Curiously, if those <code class="language-plaintext highlighter-rouge">X==Y</code> assertions hold, for two separate registers <code class="language-plaintext highlighter-rouge">X</code>
and <code class="language-plaintext highlighter-rouge">Y</code>, then … why keep both registers around?  I’d be tempted, if this
were my own design, to turn around and remove any extra registers after
seeing something like this–but we can do that after verification if we would
like.</p>

<p>When I returned to verify
<a href="https://github.com/olofk/axi_node/blob/0193125be350718e7fe8b44308f4dc44749ef60c/axi_regs_top.sv">the core</a>,
held for the first ten time steps–past the first transaction and potentially
even into the second.  That was the good news.  The bad news was that the
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>
engine suddenly slowed down after two steps.  (I had it set for 10 steps.
It counted down from 10 to 8 and … stopped.)  After about a minute, it got
to the next step, but the one after that required another five minutes.</p>

<p>This is unacceptable (in my humble opinion)–especially for a core this simple.
I really don’t want to wait that long for a tool to tell me if my design is
working or not–and especially not when doing this for a small audience.  So
I adjusted the depth again, this time from ten cycles down to four.  After
another ten minutes of processing or so, the tool produced a trace where the
design had received an address, but hadn’t responded to the bus.  It was a
timeout bug.  (Curiously, when I repeat this test without running Zoom,
the tool returns within a minute.)</p>

<p>This didn’t happen in a bounded model check, what was going on?</p>

<p>A little more sleuthing discovered a set of <code class="language-plaintext highlighter-rouge">rresp_running_reg</code> registers
that I hadn’t noticed before.  Looking over the cover traces, this register
looked like it was identical to the return valid signal.  Therefore, I
created a couple of assertions to see if this was the case.</p>

<figure class="highlight"><pre><code class="language-verilog" data-lang="verilog">	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s_axi_aresetn</span><span class="p">)</span>
       		<span class="k">assert</span><span class="p">(</span><span class="n">wresp_running_reg</span> <span class="o">==</span> <span class="n">s_axi_bvalid</span><span class="p">);</span>

	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">s_axi_aresetn</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">(</span><span class="n">rresp_running_reg</span> <span class="o">==</span> <span class="n">s_axi_rvalid</span><span class="p">);</span></code></pre></figure>

<p>Now, at this point, the design passed both the bounded model check and the
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>
pass within seconds.</p>

<p>But what about that bug?  So far, we’ve only assumed we’d never hit it.
Wouldn’t it make more sense to fix it?</p>

<p>So I added in a set of FF’s to actually latch <code class="language-plaintext highlighter-rouge">RDATA</code> and the design now
passed.  Here’s what the design used to look like,</p>

<figure class="highlight"><pre><code class="language-verilog" data-lang="verilog">	<span class="c1">// implement slave model register read mux</span>
	<span class="k">always_comb</span>
		<span class="n">data_out_reg</span> <span class="o">&lt;=</span> <span class="n">cfg_reg</span><span class="p">[</span><span class="n">raddr_reg</span><span class="p">[</span><span class="mi">7</span><span class="o">:</span><span class="mi">0</span><span class="p">]];</span></code></pre></figure>

<p>and here’s what I updated it to:</p>

<figure class="highlight"><pre><code class="language-verilog" data-lang="verilog">	<span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="kt">posedge</span> <span class="n">s_axi_aclk</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">araddr_done_reg</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">rresp_running_reg</span><span class="p">)</span>
		<span class="n">data_out_reg</span> <span class="o">&lt;=</span> <span class="n">cfg_reg</span><span class="p">[</span><span class="n">raddr_reg</span><span class="p">[</span><span class="mi">7</span><span class="o">:</span><span class="mi">0</span><span class="p">]];</span></code></pre></figure>

<p>I then removed the assumption and re-ran the proof.  Within only a couple of
seconds, this design was now verified to be <a href="/formal/2018/12/28/axilite.html">fully AXI-lite
compliant</a>.</p>

<p>In all, the whole effort took just over an hour: one hour and twenty minutes
from start to finish.  Remember, I started with a design I’d never verified
before, and I didn’t know if there were bugs within the design or not.  On
top of that, most AXI-lite designs copy from a couple of base designs–such
<a href="/formal/2018/12/28/axilite.html">as Xilinx’s (broken) demo</a>.
This one didn’t copy from anywhere that I could tell, so it was a fun new
approach to AXI-lite to examine.</p>

<h2 id="questions-asked">Questions asked</h2>

<p>During this hour, however, there was a lot of time where nothing was happening.
During that time, I asked for and responded to a variety of questions posted
on the Zoom chat channel.  No, I didn’t record the event, nor did I record the
questions posed over the chat channel.  However, I can still remember some of
the questions that were asked, and so let me share those again below.</p>

<ol>
  <li>
    <p>Will I be recording a video of the event?  or if not, would I allow someone
else to record it?</p>

    <p>My response here was, No, I was not going to be recording the event.</p>

    <p>Video production is a field in and of itself.  It’s not something I really
have any experience with, and I’m not sure how well I’d be able to do it.
Others, such as <a href="https://www.youtube.com/channel/UC1kyKOb_sv52OfVTZW5WXPg">Matt, understand the topic and do a much better job
than I expect to be able to
do</a>.
Further, I wasn’t sure if this event would even be of any value and interest
or not.</p>

    <p>So, instead, I asked the audience to let me know at the end of the
teleconference if this was something they found valuable and might
want to see a video of in the future.  If there’s an interest in it,
perhaps I can do a bit of research into what would be required.
Perhaps there might be some interest in an amateur hour, I don’t know.</p>

    <p>One of  the other individuals who joined us recommended <a href="https://www.youtube.com/watch?v=xWFo3L_weZA">Matt’s video on
“Formally verifying an AXILite core with
sby.”</a>  This video should
cover the same (rough) material I covered, yet looking at a different
AXI-lite core.  If you’d like to watch a how-to video, I’d certainly invite
you to check out this one.</p>
  </li>
  <li>
    <p>What tool was I using for formal verification?</p>

    <p>As I mentioned above, I was using <a href="https://symbiyosys.readthedocs.io/en">SymbiYosys</a>
for the formal verification.  You can also
read about <a href="/blog/2020/04/01/design-flow.html">the open source tool suite I normally use when doing design
here</a>.</p>
  </li>
  <li>
    <p>Do I always document my designs?</p>

    <p>I try.</p>

    <p>One of the things that comes with age is the recurring experience of
returning to your own work, weeks or months later, and wondering what you
were thinking when you wrote it.  This is usually when I start adding in
a lot of documentation, if not before.  Similarly, if I ever have to think
my way through a problem, then I am careful to document my train of thought
lest I not remember it five minutes later.</p>

    <p>I’ve also discovered that blogging about various designs is a great way
to document them.  The process of explaining a design to someone else
forces me to think carefully through what I’m doing and why.  In other
words, I am not just blogging for my readers and sponsors, I also blog
for my own benefit.</p>
  </li>
  <li>
    <p>Does <a href="https://symbiyosys.readthedocs.io/en">SymbiYosys</a> come with <a href="http://gtkwave.sourceforge.net">GTKWave</a>?</p>

    <p>Yes and no.  <a href="http://gtkwave.sourceforge.net">GTKWave</a>
is its own independent piece of open source software project.
I have it downloaded on my computer, and I just use it from there.
However, the commercial version of
<a href="https://symbiyosys.readthedocs.io/en">SymbiYosys</a>, which comes as part of
the SymbioticEDA Suite, comes prepackaged with a copy of
<a href="http://gtkwave.sourceforge.net">GTKWave</a> to ensure
a uniform customer experience.</p>

    <p>Technically, <a href="http://gtkwave.sourceforge.net">GTKWave</a>
isn’t required–any <a href="/blog/2017/07/31/vcd.html">VCD</a>
viewer should work nicely with
<a href="https://symbiyosys.readthedocs.io/en">SymbiYosys</a>.  Practically, I don’t
have experience with any other waveform viewing tools, so I’m not sure what
more I can say there.</p>
  </li>
  <li>
    <p>What tool do I use for the drawings on my blog?</p>

    <p>I primarily use <a href="https://wiki.gnome.org/Apps/Dia/">dia</a>.  It’s a basic
vector graphics package.  I really like it.</p>

    <p>There is another tool out there called <a href="https://inkscape.org">inkscape</a>
which is pretty nice as well.  One of the things I like about
<a href="https://wiki.gnome.org/Apps/Dia/">dia</a> over my experience with
<a href="https://inkscape.org">inkscape</a> is that it’s easy to force all diagram
element points onto a grid–something I haven’t figured out how to do
with <a href="https://inkscape.org">inkscape</a>, or if it’s even possible with
<a href="https://inkscape.org">inkscape</a>.</p>

    <p>In this article, the traces were made using
<a href="http://gtkwave.sourceforge.net">GTKWave</a>.  From there I took a screen
snapshot, saved it as a PNG file, and then imported the file into
<a href="https://wiki.gnome.org/Apps/Dia/">dia</a> in order to add any annotations.</p>

    <p>I use LaTeX to generate my <a href="/tutorial/formal.html">formal verification
courseware</a>, and Fig. 3
is simply a screen capture of a LaTeX table with some PSTricks used to
make <code class="language-plaintext highlighter-rouge">k-Induction</code> go sideways.</p>

    <p>The blobs in Figs. 4 and 5 were created using
<a href="https://wiki.gnome.org/Apps/Dia/">dia</a>.  If you check out <a href="/tutorial/formal.html">my formal
verification courseware</a>, you’ll
see that I use the same blobs there–albeit with a bit more explanation and
context.</p>
  </li>
  <li>
    <p>Are there any consequences to having too many assertions?  Might a design
vacuously pass?</p>

    <p>This was a really good question.  From the viewer’s perspective,
it probably looked like I was just throwing random assertions into the
design to see what would stick.  Indeed, there was some truth to this as
I was trying to get the design to pass
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>.
So what are the consequences here of being wrong?  What if you add an
inappropriate assertion?  Or, alternatively, what if your assertions are
redundant?</p>

    <p>Let’s deal with the inappropriate assertion first.  Suppose I make an
assertion of something that isn’t really true.  What happens then?  That’s
easy: the design will fail to prove.  When the proof fails,
<a href="https://symbiyosys.readthedocs.io/en">SymbiYosys</a> will
generate a trace showing the problem, and you can then examine it to decide
if the assertion was in error or if, instead, the design was in error.
Indeed, that’s <a href="/blog/2017/10/19/formal-intro.html">the whole purpose of formal
verification</a>: to
find failing assertions.</p>

    <p>It is also possible to assert the same thing more than once, or in multiple
different ways.  This isn’t really much of a <em>problem</em> though.  While it
might cause some small performance hit, your design still won’t pass when it
shouldn’t–so you are still okay there.</p>
  </li>
</ol>

<table align="center" style="float: right"><caption>Fig 7. The master rule of formal verification</caption><tr><td><img src="/img/fv-master-rule.svg" alt="" width="360" /></td></tr></table>

<p>Where things get scary are with assumptions–not assertions.  If you assume
   something you
   shouldn’t, then you might cause your design to pass vacuously.  (i.e., it
   passes when it shouldn’t.)  To keep this from happening, I have a rule
   that you should only make assumptions of inputs–never outputs nor registers
   internal to your design.  Even at this, though, I’ve made mistakes where
   I’ve assumed things that weren’t true.  My current best answer is to use
   <a href="/formal/2020/06/12/four-keys.html">custom interface files</a>,
   so that everything that gets assumed on one side of an interface gets
   asserted on the other side.  While this doesn’t work for all of my problems,
   when it does work it works amazingly well.</p>

<ol start="7">
  <li>
    <p>Where can I learn more about
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>?</p>

    <p>I have two good resources on
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>
for those who are interested.  The first is <a href="/blog/2018/03/10/induction-exercise.html">my blog post on the
topic</a>, and the
second are the <a href="/tutorial/formal.html">formal verification class
slides</a>.  Both will tell you a
bit about how to do
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>, and
the unique problems associated with it.</p>
  </li>
  <li>
    <p>Is there any way to get the tool to provide more meaningful names for
cover traces other than just <code class="language-plaintext highlighter-rouge">trace%d.vcd</code>?</p>

    <p>Not that I know of.  I know I had asked for this feature some time
ago.  Looking over the issue tracker, it looks like
<a href="https://github.com/YosysHQ/SymbiYosys/issues/24">Tom Verbeure also requested the
feature</a>.
<a href="https://github.com/YosysHQ/SymbiYosys/issues/24">That request</a>
hasn’t yet been closed, so I think it’s safe to assume the feature doesn’t
exist yet.</p>
  </li>
  <li>
    <p>Why do you need to provide the counters to the <a href="https://github.com/ZipCPU/wb2axip/blob/master/bench/formal/faxil_slave.v">bus interface property
module</a>?</p>

    <p>This question was asked in reference to the three counters,
<code class="language-plaintext highlighter-rouge">faxil_awr_outstanding</code>, <code class="language-plaintext highlighter-rouge">faxil_wr_outstanding</code>, and
<code class="language-plaintext highlighter-rouge">faxil_rd_outstanding</code>.  The immediate answer to the question is that I’m
not providing them to the <a href="https://github.com/ZipCPU/wb2axip/blob/master/bench/formal/faxil_slave.v">interface property
module</a>,
but rather it’s the other way around: the <a href="https://github.com/ZipCPU/wb2axip/blob/master/bench/formal/faxil_slave.v">interface property
module</a>
is providing those counters as outputs to the rest of the design.</p>

    <p>Are they necessary?  For a bounded proof, they can be left as internal
counters within the interface property set.  For an
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>
proof, however, you <em>need</em> to tie the registers within your design to
these counters via assertions–or the proof won’t pass.</p>

    <p>Go back and take another look at the assertions we made above to pass
<a href="/blog/2018/03/10/induction-exercise.html">induction</a>.
See how this was done?  First we asserted there would never be more than
one transaction outstanding, then we came back and said that if there ever
was a transaction outstanding then the <code class="language-plaintext highlighter-rouge">*_done_reg</code> had to be set and the
<code class="language-plaintext highlighter-rouge">*resp_done_reg</code> had to be clear.  That’s an important part of making our
formal proof valid for all time, as well as for accomplishing the whole proof
in only four steps.</p>
  </li>
  <li>
    <p>Can I see some part of this design or other?</p>
  </li>
</ol>

<p>One of the challenging problems of working with a design that doesn’t fit
   on the screen is that there will always be viewers who can’t see some part
   of it that they are interested in.  Since only the most trivial designs
   tend to fit on a screen at once, this means someone will always be struggling
   to follow–which is one of the reasons why I tend to dislike the video
   format for learning.</p>

<p>Still, in case anyone wanted to study the design or the formal
   properties I added to it, I placed a copy in a <a href="https://gist.github.com/ZipCPU/497c85a0dc7b84e9cd05b3ddf1bc2487">github
   gist</a>.
   Feel free to check it out.  There should be a decent comment block at the
   top of the SV file describing what we did.  You might also wish to compare
   the result against the <a href="https://github.com/olofk/axi_node/blob/0193125be350718e7fe8b44308f4dc44749ef60c/axi_regs_top.sv">design we started from</a>,
   to see any differences.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Ok, so I admitted it up front. I was just in it to have a fun evening.  I
didn’t write down any business contacts, I didn’t keep track of potential
clients, I didn’t do any customer satisfaction surveys, or try to ask questions
like if anyone had ever used formal before or not and why or why not.  Neither
did I dress up in a suit or tie, and those who showed up early may have even
seen the soda can on my desk.</p>

<p>Towards that end, I think I succeeded.</p>

<p>Did my work help someone out?  Probably not.  I checked with
<a href="https://twitter.com/OlofKindgren">Olof</a>, who hosts <a href="https://github.com/olofk/axi_node">this repository on
github</a>, only to find out that the
authors had since <a href="https://github.com/pulp-platform/axi">rewritten everything</a>
and so I was only verifying abandonware.  So, this wasn’t really all that much
of a good deed for the community from that standpoint.</p>

<p>Now, let me ask you, my sponsors and readers, and especially those who were
able to join me: is this something you’d like to see more of?  Those who were
there asked for more, but I’d love to hear your thoughts as well.  Please let me
know if so.  To that end, I’ll post a link to this article on the
<a href="https://reddit.com/r/ZipCPU">ZipCPU Reddit</a>–as I have with most of my
articles, where you’ll be able to comment one way or another if you would like
to weigh in on the question.</p>

<p>Oh, and one more thing: I might need some help finding some other open source
AXI projects to verify for this purpose.  Someone pointed me towards
<a href="https://github.com/alexforencich/verilog-axi">alexforencich’s repo</a> as
one possibility, and I’m also aware of <a href="https://github.com/pulp-platform/axi">the updated pulp-platform
AXI repo</a>, but I’ll need more than
just those two in order to do this more than just a couple of times–assuming
there’s sufficient interest for it.</p>

  </div>


<div class "verse">
<HR align="center;" width="25%">
<P><em>And after the reading of the law and the prophets the rulers of the synagogue sent unto them, saying, Ye men and brethren, if ye have any word of exhortation for the people, say on.  (Acts 13:15)</em>


</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">The ZipCPU by Gisselquist Technology</h2>
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <!-- <li></li> -->
          <li><a href="mailto:zipcpu@gmail.com">zipcpu@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="soc-medlist">
          
          <li>
            <a href="https://github.com/ZipCPU"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">ZipCPU</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/zipcpu"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">@zipcpu</span></a>

          </li>
          
          
          <li><A href="https://www.patreon.com/ZipCPU"><img src="/img/become_a_patron_button.png"></a></li>
          

        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>The ZipCPU blog, featuring how to discussions of FPGA and soft-core CPU design.  This site will be focused on Verilog solutions, using exclusively OpenSource IP products for FPGA design.  Particular focus areas include topics often left out of more mainstream FPGA design courses such as how to debug an FPGA design.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
